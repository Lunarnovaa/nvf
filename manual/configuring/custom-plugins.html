<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Custom Plugins {#ch-custom-plugins}</title>
    <script>
      // Apply sidebar state immediately to prevent flash
      (function () {
        if (localStorage.getItem("sidebar-collapsed") === "true") {
          document.documentElement.classList.add("sidebar-collapsed");
        }
      })();
    </script>
    <link rel="stylesheet" href="../../assets/style.css" />
    <script defer src="../../assets/main.js"></script>
    
    <script defer src="../../assets/search.js"></script>
    
  </head>
  <body>
    <div class="container">
      <header>
        <div class="header-left">
          <h1 class="site-title">
            <a href="../../index.html">nvf</a>
          </h1>
        </div>
        <nav class="header-nav">
          <ul>
            <li >
              <a href="../../options.html">Options</a>
            </li>
            
            <li><a href="../../search.html">Search</a></li>
            
          </ul>
        </nav>
        
        <div class="search-container">
          <input type="text" id="search-input" placeholder="Search..." />
          <div id="search-results" class="search-results"></div>
        </div>
        
      </header>

      <div class="layout">
        <div class="sidebar-toggle" aria-label="Toggle sidebar">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 24 24"
            width="24"
            height="24"
          >
            <path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"></path>
          </svg>
        </div>
        <nav class="sidebar">
          <div class="docs-nav">
            <h2>Documents</h2>
            <ul>
              <li><a href="../../release-notes/release-notes.html">Release Notes</a></li>
<li><a href="../../release-notes/rl-0.5.html">Release 0.5 {#sec-release-0.5}</a></li>
<li><a href="../../release-notes/rl-0.4.html">Release 0.4 {#sec-release-0.4}</a></li>
<li><a href="../../release-notes/rl-0.3.html">Release 0.3 {#sec-release-0.3}</a></li>
<li><a href="../../release-notes/rl-0.8.html">Release 0.8 {#sec-release-0.8}</a></li>
<li><a href="../../release-notes/rl-0.1.html">Release 0.1 {#sec-release-0.1}</a></li>
<li><a href="../../release-notes/rl-0.2.html">Release 0.2 {#sec-release-0.2}</a></li>
<li><a href="../../release-notes/rl-0.7.html">Release 0.7 {#sec-release-0.7}</a></li>
<li><a href="../../release-notes/rl-0.6.html">Release 0.6 {#sec-release-0.6}</a></li>
<li><a href="../../manual/installation/custom-configuration.html">Standalone Installation</a></li>
<li><a href="../../manual/installation/modules.html">Module Installation</a></li>
<li><a href="../../manual/installation/standalone/nixos.html">Standalone Installation on NixOS</a></li>
<li><a href="../../manual/installation/standalone/home-manager.html">Standalone Installation on Home-Manager</a></li>
<li><a href="../../manual/installation/modules/nixos.html">NixOS Module</a></li>
<li><a href="../../manual/installation/modules/home-manager.html">Home-Manager Module</a></li>
<li><a href="../../manual/quirks.html">Known Issues and Quirks</a></li>
<li><a href="../../manual/configuring.html">Configuring nvf</a></li>
<li><a href="../../manual/tips.html">Helpful Tips</a></li>
<li><a href="../../manual/try-it-out.html">Try it out</a></li>
<li><a href="../../manual/options.html">nvf Configuration Options</a></li>
<li><a href="../../manual/quirks/nodejs.html">NodeJS</a></li>
<li><a href="../../manual/configuring/languages.html">Language Support</a></li>
<li><a href="../../manual/configuring/autocmds.html">Autocommands and Autogroups</a></li>
<li><a href="../../manual/configuring/custom-package.html">Custom Neovim Package</a></li>
<li><a href="../../manual/configuring/overriding-plugins.html">Overriding plugins</a></li>
<li><a href="../../manual/configuring/languages/lsp.html">LSP Custom Packages/Command</a></li>
<li><a href="../../manual/configuring/custom-plugins.html">Custom Plugins</a></li>
<li><a href="../../manual/configuring/dag-entries.html">DAG entries in nvf</a></li>
<li><a href="../../manual/configuring/dags.html">Using DAGs</a></li>
<li><a href="../../manual/configuring/custom-plugins/non-lazy-method.html">Non-lazy Method</a></li>
<li><a href="../../manual/configuring/custom-plugins/configuring.html">Configuring</a></li>
<li><a href="../../manual/configuring/custom-plugins/legacy-method.html">Legacy Method</a></li>
<li><a href="../../manual/configuring/custom-plugins/lazy-method.html">Lazy Method</a></li>
<li><a href="../../manual/hacking/additional-plugins.html">Adding Plugins</a></li>
<li><a href="../../manual/hacking/getting-started.html">Getting Started</a></li>
<li><a href="../../manual/hacking/guidelines.html">Guidelines</a></li>
<li><a href="../../manual/hacking/testing.html">Testing Changes</a></li>
<li><a href="../../manual/hacking/keybinds.html">Keybinds</a></li>
<li><a href="../../manual/installation.html">Installing nvf</a></li>
<li><a href="../../manual/manual.html">nvf manual</a></li>
<li><a href="../../manual/hacking.html">Hacking nvf</a></li>
<li><a href="../../manual/tips/debugging-nvf.html">Debugging nvf</a></li>
<li><a href="../../manual/tips/offline-docs.html">Offline Documentation</a></li>
<li><a href="../../manual/tips/plugin-sources.html">Adding Plugins From Different Sources</a></li>
<li><a href="../../manual/tips/pure-lua-config.html">Pure Lua Configuration</a></li>
<li><a href="../../manual/preface.html">Preface</a></li>
<li><a href="../../search.html">Search</a></li>

            </ul>
          </div>

          <div class="toc">
            <h2>Contents</h2>
            <ul class="toc-list">
              <li><a href="#ch-custom-plugins">Custom Plugins {#ch-custom-plugins}</a>
<ul><li><a href="#ch-adding-plugins">Adding Plugins {#ch-adding-plugins}</a>
</ul><li><a href="#sec-configuring-plugins">Configuring {#sec-configuring-plugins}</a>
<ul><li><a href="#ch-vim-lazy-plugins">Lazy Plugins {#ch-vim-lazy-plugins}</a>
<li><a href="#ch-vim-extra-plugins">Standard API {#ch-vim-extra-plugins}</a>
<ul><li><a href="#setup-using-luaconfigrc">Setup using luaConfigRC {#setup-using-luaconfigrc}</a>
</ul><li><a href="#sec-lazyfile-event">LazyFile event {#sec-lazyfile-event}</a>
</ul><li><a href="#sec-non-lazy-method">Non-lazy Method {#sec-non-lazy-method}</a>
<li><a href="#sec-legacy-method">Legacy Method {#sec-legacy-method}</a>
<ul><li><a href="#sec-adding-new-plugins">Adding New Plugins {#sec-adding-new-plugins}</a>
</li></ul></li>
            </ul>
          </div>
        </nav>

        <main class="content"><h1 id="ch-custom-plugins"><a href="#custom-plugins-ch-custom-plugins" aria-hidden="true" class="anchor" id="custom-plugins-ch-custom-plugins"></a>Custom Plugins</h1>
<p><strong>nvf</strong> exposes a very wide variety of plugins by default, which are consumed by
module options. This is done for your convenience, and to bundle all necessary
dependencies into <strong>nvf</strong>'s runtime with full control of versioning, testing and
dependencies. In the case a plugin you need is <em>not</em> available, you may consider
making a pull request to add the package you're looking for, or you may add it
to your configuration locally. The below section describes how new plugins may
be added to the user's configuration.</p>
<h2 id="ch-adding-plugins"><a href="#adding-plugins-ch-adding-plugins" aria-hidden="true" class="anchor" id="adding-plugins-ch-adding-plugins"></a>Adding Plugins</h2>
<p>Per <strong>nvf</strong>'s design choices, there are several ways of adding custom plugins to
your configuration as you need them. As we aim for extensive configuration, it
is possible to add custom plugins (from nixpkgs, pinning tools, flake inputs,
etc.) to your Neovim configuration before they are even implemented in <strong>nvf</strong>
as a module.</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>To add a plugin to your runtime, you will need to add it to
<a href="#opt-vim.startPlugins"></a> list in your configuration. This is akin to cloning a
plugin to <code>~/.config/nvim</code>, but they are only ever placed in the Nix store and
never exposed to the outside world for purity and full isolation.</p>
</div>
<p>As you would configure a cloned plugin, you must configure the new plugins that
you've added to <code>startPlugins.</code> <strong>nvf</strong> provides multiple ways of configuring
any custom plugins that you might have added to your configuration.</p>
<h1 id="sec-configuring-plugins"><a href="#configuring-sec-configuring-plugins" aria-hidden="true" class="anchor" id="configuring-sec-configuring-plugins"></a>Configuring</h1>
<p>Just making the plugin to your Neovim configuration available might not always
be enough., for example, if the plugin requires a setup table. In that case, you
can write custom Lua configuration using one of</p>
<ul>
<li><code>config.vim.lazy.plugins.*.setupOpts</code></li>
<li><code>config.vim.extraPlugins.*.setup</code></li>
<li><a href="options.html#option-config-vim-luaConfigRC" class="option-reference"><code>config.vim.luaConfigRC</code></a>.</li>
</ul>
<h2 id="ch-vim-lazy-plugins"><a href="#lazy-plugins-ch-vim-lazy-plugins" aria-hidden="true" class="anchor" id="lazy-plugins-ch-vim-lazy-plugins"></a>Lazy Plugins</h2>
<p><code>config.vim.lazy.plugins.*.setupOpts</code> is useful for lazy-loading plugins, and
uses an extended version of <code>lz.n's</code> <code>PluginSpec</code> to expose a familiar
interface. <code>setupModule</code> and <code>setupOpt</code> can be used if the plugin uses a
<code>require('module').setup(...)</code> pattern. Otherwise, the <code>before</code> and <code>after</code>
hooks should do what you need.</p>
<pre><code class="language-nix">{
  config.vim.lazy.plugins = {
    aerial.nvim = {
    # ^^^^^^^^^ this name should match the package.pname or package.name
      package = aerial-nvim;

      setupModule = &quot;aerial&quot;;
      setupOpts = {option_name = false;};

      after = &quot;print('aerial loaded')&quot;;
    };
  };
}
</code></pre>
<h2 id="ch-vim-extra-plugins"><a href="#standard-api-ch-vim-extra-plugins" aria-hidden="true" class="anchor" id="standard-api-ch-vim-extra-plugins"></a>Standard API</h2>
<p><a href="options.html#option-vim-extraPlugins" class="option-reference"><code>vim.extraPlugins</code></a> uses an attribute set, which maps DAG section names to a
custom type, which has the fields <code>package</code>, <code>after</code>, <code>setup</code>. They allow you to
set the package of the plugin, the sections its setup code should be after (note
that the <code>extraPlugins</code> option has its own DAG scope), and the its setup code
respectively. For example:</p>
<pre><code class="language-nix">{pkgs, ...}: {
  config.vim.extraPlugins = {
    aerial = {
      package = pkgs.vimPlugins.aerial-nvim;
      setup = &quot;require('aerial').setup {}&quot;;
    };

    harpoon = {
      package = pkgs.vimPlugins.harpoon;
      setup = &quot;require('harpoon').setup {}&quot;;
      after = [&quot;aerial&quot;]; # place harpoon configuration after aerial
    };
  };
}
</code></pre>
<h3 id="setup-using-luaconfigrc"><a href="#setup-using-luaconfigrc-setup-using-luaconfigrc" aria-hidden="true" class="anchor" id="setup-using-luaconfigrc-setup-using-luaconfigrc"></a>Setup using luaConfigRC</h3>
<p><a href="options.html#option-vim-luaConfigRC" class="option-reference"><code>vim.luaConfigRC</code></a> also uses an attribute set, but this one is resolved as a DAG
directly. The attribute names denote the section names, and the values lua code.
For example:</p>
<pre><code class="language-nix">{
  # This will create a section called &quot;aquarium&quot; in the 'init.lua' with the
  # contents of your custom configuration. By default 'entryAnywhere' is implied
  # in DAGs, so this will be inserted to an arbitrary position. In the case you 
  # wish to control the position of this section with more precision, please
  # look into the DAGs section of the manual.
  config.vim.luaConfigRC.aquarium = &quot;vim.cmd('colorscheme aquiarum')&quot;;
}
</code></pre>
<!-- deno-fmt-ignore-start -->
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>One of the <strong>greatest strengths</strong> of <strong>nvf</strong> is the ability to order
configuration snippets precisely using the [DAG system]. DAGs
are a very powerful mechanism that allows specifying positions
of individual sections of configuration as needed. We provide helper functions
in the extended library, usually under <a href="options.html#option-inputs-nvf-lib-nvim-dag" class="option-reference"><code>inputs.nvf.lib.nvim.dag</code></a> that you may
use.</p>
<p>Please refer to the [DAG section] in the nvf manual
to find out more about the DAG system.</p>
</div>
<!-- deno-fmt-ignore-end -->
# Lazy Method {#sec-lazy-method}
<p>As of version <strong>0.7</strong>, an API is exposed to allow configuring lazy-loaded
plugins via <a href="options.html#option-lz-n" class="option-reference"><code>lz.n</code></a> and <code>lzn-auto-require</code>. Below is a comprehensive example of
how it may be loaded to lazy-load an arbitrary plugin.</p>
<pre><code class="language-nix">{
  config.vim.lazy.plugins = {
    &quot;aerial.nvim&quot; = {
      package = pkgs.vimPlugins.aerial-nvim;
      setupModule = &quot;aerial&quot;;
      setupOpts = {
        option_name = true;
      };
      after = ''
        -- custom lua code to run after plugin is loaded
        print('aerial loaded')
      '';

      # Explicitly mark plugin as lazy. You don't need this if you define one of
      # the trigger &quot;events&quot; below
      lazy = true;

      # load on command
      cmd = [&quot;AerialOpen&quot;];

      # load on event
      event = [&quot;BufEnter&quot;];

      # load on keymap
      keys = [
        {
          key = &quot;&lt;leader&gt;a&quot;;
          action = &quot;:AerialToggle&lt;CR&gt;&quot;;
        }
      ];
    };
  };
}
</code></pre>
<h2 id="sec-lazyfile-event"><a href="#lazyfile-event-sec-lazyfile-event" aria-hidden="true" class="anchor" id="lazyfile-event-sec-lazyfile-event"></a>LazyFile event</h2>
<p><strong>nvf</strong> re-implements <code>LazyFile</code> as a familiar user event to load a plugin when
a file is opened:</p>
<pre><code class="language-nix">{
  config.vim.lazy.plugins = {
    &quot;aerial.nvim&quot; = {
      package = pkgs.vimPlugins.aerial-nvim;
      event = [{event = &quot;User&quot;; pattern = &quot;LazyFile&quot;;}];
      # ...
    };
  };
}
</code></pre>
<p>You can consider the <code>LazyFile</code> event as an alias to the combination of
<code>&quot;BufReadPost&quot;</code>, <code>&quot;BufNewFile&quot;</code> and <code>&quot;BufWritePre&quot;</code>, i.e., a list containing all
three of those events: <code>[&quot;BufReadPost&quot; &quot;BufNewFile&quot; &quot;BufWritePre&quot;]</code></p>
<h1 id="sec-non-lazy-method"><a href="#non-lazy-method-sec-non-lazy-method" aria-hidden="true" class="anchor" id="non-lazy-method-sec-non-lazy-method"></a>Non-lazy Method</h1>
<p>As of version <strong>0.5</strong>, we have a more extensive API for configuring plugins that
should be preferred over the legacy method. This API is available as
<a href="#opt-vim.extraPlugins"></a>. Instead of using DAGs exposed by the library
<em>directly</em>, you may use the extra plugin module as follows:</p>
<pre><code class="language-nix">{pkgs, ...}: {
  config.vim.extraPlugins = {
    aerial = {
      package = pkgs.vimPlugins.aerial-nvim;
      setup = ''
        require('aerial').setup {
          -- some lua configuration here
        }
      '';
    };

    harpoon = {
      package = pkgs.vimPlugins.harpoon;
      setup = &quot;require('harpoon').setup {}&quot;;
      after = [&quot;aerial&quot;];
    };
  };
}
</code></pre>
<p>This provides a level of abstraction over the DAG system for faster iteration.</p>
<h1 id="sec-legacy-method"><a href="#legacy-method-sec-legacy-method" aria-hidden="true" class="anchor" id="legacy-method-sec-legacy-method"></a>Legacy Method</h1>
<p>Prior to version <strong>0.5</strong>, the method of adding new plugins was adding the plugin
package to <a href="#opt-vim.startPlugins"></a> and adding its configuration as a DAG under
one of <a href="options.html#option-vim-configRC" class="option-reference"><code>vim.configRC</code></a> or <a href="#opt-vim.luaConfigRC"></a>. While <code>configRC</code> has been
deprecated, users who have not yet updated to 0.5 or those who prefer a more
hands-on approach may choose to use the old method where the load order of the
plugins is explicitly determined by DAGs without internal abstractions.</p>
<h2 id="sec-adding-new-plugins"><a href="#adding-new-plugins-sec-adding-new-plugins" aria-hidden="true" class="anchor" id="adding-new-plugins-sec-adding-new-plugins"></a>Adding New Plugins</h2>
<p>To add a plugin not available in <strong>nvf</strong> as a module to your configuration using
the legacy method, you must add it to <a href="#opt-vim.startPlugins"></a> in order to make
it available to Neovim at runtime.</p>
<pre><code class="language-nix">{pkgs, ...}: {
  # Add a Neovim plugin from Nixpkgs to the runtime.
  # This does not need to come explicitly from packages. 'vim.startPlugins'
  # takes a list of *string* (to load internal plugins) or *package* to load
  # a Neovim package from any source.
  vim.startPlugins = [pkgs.vimPlugins.aerial-nvim];
}
</code></pre>
<p>Once the package is available in Neovim's runtime, you may use the <code>luaConfigRC</code>
option to provide configuration as a DAG using the <strong>nvf</strong> extended library in
order to configure the added plugin,</p>
<pre><code class="language-nix">{inputs, ...}: let
  # This assumes you have an input called 'nvf' in your flake inputs
  # and 'inputs' in your specialArgs. In the case you have passed 'nvf'
  # to specialArgs, the 'inputs' prefix may be omitted.
  inherit (inputs.nvf.lib.nvim.dag) entryAnywhere;
in {
  # luaConfigRC takes Lua configuration verbatim and inserts it at an arbitrary
  # position by default or if 'entryAnywhere' is used.
  vim.luaConfigRC.aerial-nvim= entryAnywhere ''
    require('aerial').setup {
      -- your configuration here
    }
  '';
}
</code></pre>
</main>
      </div>

      <footer>
        <p></p>
      </footer>
    </div>

    
  </body>
</html>
