<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Helpful Tips {#ch-helpful-tips}</title>
    <script>
      // Apply sidebar state immediately to prevent flash
      (function () {
        if (localStorage.getItem("sidebar-collapsed") === "true") {
          document.documentElement.classList.add("sidebar-collapsed");
        }
      })();
    </script>
    <link rel="stylesheet" href="../assets/style.css" />
    <script defer src="../assets/main.js"></script>
    
    <script defer src="../assets/search.js"></script>
    
  </head>
  <body>
    <div class="container">
      <header>
        <div class="header-left">
          <h1 class="site-title">
            <a href="../index.html">nvf</a>
          </h1>
        </div>
        <nav class="header-nav">
          <ul>
            <li >
              <a href="../options.html">Options</a>
            </li>
            
            <li><a href="../search.html">Search</a></li>
            
          </ul>
        </nav>
        
        <div class="search-container">
          <input type="text" id="search-input" placeholder="Search..." />
          <div id="search-results" class="search-results"></div>
        </div>
        
      </header>

      <div class="layout">
        <div class="sidebar-toggle" aria-label="Toggle sidebar">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 24 24"
            width="24"
            height="24"
          >
            <path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"></path>
          </svg>
        </div>
        <nav class="sidebar">
          <div class="docs-nav">
            <h2>Documents</h2>
            <ul>
              <li><a href="../release-notes/release-notes.html">Release Notes</a></li>
<li><a href="../release-notes/rl-0.5.html">Release 0.5 {#sec-release-0.5}</a></li>
<li><a href="../release-notes/rl-0.4.html">Release 0.4 {#sec-release-0.4}</a></li>
<li><a href="../release-notes/rl-0.3.html">Release 0.3 {#sec-release-0.3}</a></li>
<li><a href="../release-notes/rl-0.8.html">Release 0.8 {#sec-release-0.8}</a></li>
<li><a href="../release-notes/rl-0.1.html">Release 0.1 {#sec-release-0.1}</a></li>
<li><a href="../release-notes/rl-0.2.html">Release 0.2 {#sec-release-0.2}</a></li>
<li><a href="../release-notes/rl-0.7.html">Release 0.7 {#sec-release-0.7}</a></li>
<li><a href="../release-notes/rl-0.6.html">Release 0.6 {#sec-release-0.6}</a></li>
<li><a href="../manual/installation/custom-configuration.html">Standalone Installation</a></li>
<li><a href="../manual/installation/modules.html">Module Installation</a></li>
<li><a href="../manual/installation/standalone/nixos.html">Standalone Installation on NixOS</a></li>
<li><a href="../manual/installation/standalone/home-manager.html">Standalone Installation on Home-Manager</a></li>
<li><a href="../manual/installation/modules/nixos.html">NixOS Module</a></li>
<li><a href="../manual/installation/modules/home-manager.html">Home-Manager Module</a></li>
<li><a href="../manual/quirks.html">Known Issues and Quirks</a></li>
<li><a href="../manual/configuring.html">Configuring nvf</a></li>
<li><a href="../manual/tips.html">Helpful Tips</a></li>
<li><a href="../manual/try-it-out.html">Try it out</a></li>
<li><a href="../manual/options.html">nvf Configuration Options</a></li>
<li><a href="../manual/quirks/nodejs.html">NodeJS</a></li>
<li><a href="../manual/configuring/languages.html">Language Support</a></li>
<li><a href="../manual/configuring/autocmds.html">Autocommands and Autogroups</a></li>
<li><a href="../manual/configuring/custom-package.html">Custom Neovim Package</a></li>
<li><a href="../manual/configuring/overriding-plugins.html">Overriding plugins</a></li>
<li><a href="../manual/configuring/languages/lsp.html">LSP Custom Packages/Command</a></li>
<li><a href="../manual/configuring/custom-plugins.html">Custom Plugins</a></li>
<li><a href="../manual/configuring/dag-entries.html">DAG entries in nvf</a></li>
<li><a href="../manual/configuring/dags.html">Using DAGs</a></li>
<li><a href="../manual/configuring/custom-plugins/non-lazy-method.html">Non-lazy Method</a></li>
<li><a href="../manual/configuring/custom-plugins/configuring.html">Configuring</a></li>
<li><a href="../manual/configuring/custom-plugins/legacy-method.html">Legacy Method</a></li>
<li><a href="../manual/configuring/custom-plugins/lazy-method.html">Lazy Method</a></li>
<li><a href="../manual/hacking/additional-plugins.html">Adding Plugins</a></li>
<li><a href="../manual/hacking/getting-started.html">Getting Started</a></li>
<li><a href="../manual/hacking/guidelines.html">Guidelines</a></li>
<li><a href="../manual/hacking/testing.html">Testing Changes</a></li>
<li><a href="../manual/hacking/keybinds.html">Keybinds</a></li>
<li><a href="../manual/installation.html">Installing nvf</a></li>
<li><a href="../manual/manual.html">nvf manual</a></li>
<li><a href="../manual/hacking.html">Hacking nvf</a></li>
<li><a href="../manual/tips/debugging-nvf.html">Debugging nvf</a></li>
<li><a href="../manual/tips/offline-docs.html">Offline Documentation</a></li>
<li><a href="../manual/tips/plugin-sources.html">Adding Plugins From Different Sources</a></li>
<li><a href="../manual/tips/pure-lua-config.html">Pure Lua Configuration</a></li>
<li><a href="../manual/preface.html">Preface</a></li>
<li><a href="../search.html">Search</a></li>

            </ul>
          </div>

          <div class="toc">
            <h2>Contents</h2>
            <ul class="toc-list">
              <li><a href="#ch-helpful-tips">Helpful Tips {#ch-helpful-tips}</a>
<li><a href="#sec-debugging-nvf">Debugging nvf {#sec-debugging-nvf}</a>
<ul><li><a href="#accessing-neovimconfig---sec-accessing-config">Accessing neovimConfig {#sec-accessing-config}</a>
</ul><li><a href="#sec-offline-documentation">Offline Documentation {#sec-offline-documentation}</a>
<li><a href="#sec-pure-lua-config">Pure Lua Configuration {#sec-pure-lua-config}</a>
<ul><li><a href="#sec-pure-nvf-runtime">Pure Runtime Directory {#sec-pure-nvf-runtime}</a>
<li><a href="#sec-impure-absolute-dir">Impure Absolute Directory {#sec-impure-absolute-dir}</a>
</ul><li><a href="#sec-plugin-sources">Adding Plugins From Different Sources {#sec-plugin-sources}</a>
<ul><li><a href="#ch-plugins-from-nixpkgs">Nixpkgs & Friends {#ch-plugins-from-nixpkgs}</a>
<li><a href="#ch-plugins-from-source">Building Your Own Plugins {#ch-plugins-from-source}</a>
</li></ul></li>
            </ul>
          </div>
        </nav>

        <main class="content"><h1 id="ch-helpful-tips"><a href="#helpful-tips-ch-helpful-tips" aria-hidden="true" class="anchor" id="helpful-tips-ch-helpful-tips"></a>Helpful Tips</h1>
<p>This section provides helpful tips that may be considered &quot;unorthodox&quot; or &quot;too
advanced&quot; for some users. We will cover basic debugging steps, offline
documentation, configuring <strong>nvf</strong> with pure Lua and using custom plugin sources
in <strong>nvf</strong> in this section. For general configuration tips, please see previous
chapters.</p>
<h1 id="sec-debugging-nvf"><a href="#debugging-nvf-sec-debugging-nvf" aria-hidden="true" class="anchor" id="debugging-nvf-sec-debugging-nvf"></a>Debugging nvf</h1>
<p>There may be instances where the your Nix configuration evaluates to invalid
Lua, or times when you will be asked to provide your built Lua configuration for
easier debugging by nvf maintainers. nvf provides two helpful utilities out of
the box.</p>
<p><strong>nvf-print-config</strong> and <strong>nvf-print-config-path</strong> will be bundled with nvf as
lightweight utilities to help you view or share your built configuration when
necessary.</p>
<p>To view your configuration with syntax highlighting, you may use the
<a href="<a href="https://github.com/sharkdp/bat">https://github.com/sharkdp/bat</a>">bat pager</a>.</p>
<pre><code class="language-bash">nvf-print-config | bat --language=lua
</code></pre>
<p>Alternatively, <code>cat</code> or <code>less</code> may also be used.</p>
<h2 id="sec-accessing-config"><a href="#accessing-neovimconfig-sec-accessing-config" aria-hidden="true" class="anchor" id="accessing-neovimconfig-sec-accessing-config"></a>Accessing <code>neovimConfig</code></h2>
<p>It is also possible to access the configuration for the wrapped package. The
<em>built</em> Neovim package will contain a <code>neovimConfig</code> attribute in its
<code>passthru</code>.</p>
<h1 id="sec-offline-documentation"><a href="#offline-documentation-sec-offline-documentation" aria-hidden="true" class="anchor" id="offline-documentation-sec-offline-documentation"></a>Offline Documentation</h1>
<p>The manpages provided by nvf contains an offline version of the option search
normally available at <a href="<a href="https://notashelf.github.io/nvf/options.html">https://notashelf.github.io/nvf/options.html</a>"><a href="https://notashelf.github.io/nvf/options.html">https://notashelf.github.io/nvf/options.html</a></a>. You may
use the <code>man 5 nvf</code> command to view option documentation from the comfort of
your terminal.</p>
<p>Note that this is only available for NixOS and Home-Manager module
installations.</p>
<h1 id="sec-pure-lua-config"><a href="#pure-lua-configuration-sec-pure-lua-config" aria-hidden="true" class="anchor" id="pure-lua-configuration-sec-pure-lua-config"></a>Pure Lua Configuration</h1>
<p>We recognize that you might not always want to configure your setup purely in
Nix, sometimes doing things in Lua is simply the &quot;superior&quot; option. In such a
case you might want to configure your Neovim instance using Lua, and nothing but
Lua. It is also possible to mix Lua and Nix configurations.</p>
<p>Pure Lua or hybrid Lua/Nix configurations can be achieved in two different ways.
<em>Purely</em>, by modifying Neovim's runtime directory or <em>impurely</em> by placing Lua
configuration in a directory found in <code class="terminal"><span class="prompt">$</span> HOME</code>. For your convenience, this
section will document both methods as they can be used.</p>
<h2 id="sec-pure-nvf-runtime"><a href="#pure-runtime-directory-sec-pure-nvf-runtime" aria-hidden="true" class="anchor" id="pure-runtime-directory-sec-pure-nvf-runtime"></a>Pure Runtime Directory</h2>
<p>As of 0.6, nvf allows you to modify Neovim's runtime path to suit your needs.
One of the ways the new runtime option is to add a configuration <strong>located
relative to your <a href="options.html#option-flake-nix" class="option-reference"><code>flake.nix</code></a></strong>, which must be version controlled in pure flakes
manner.</p>
<pre><code class="language-nix">{
  # Let us assume we are in the repository root, i.e., the same directory as the
  # flake.nix. For the sake of the argument, we will assume that the Neovim lua
  # configuration is in a nvim/ directory relative to flake.nix.
  vim = {
    additionalRuntimeDirectories = [
      # This will be added to Neovim's runtime paths. Conceptually, this behaves
      # very similarly to ~/.config/nvim but you may not place a top-level
      # init.lua to be able to require it directly.
      ./nvim
    ];
  };
}
</code></pre>
<p>This will add the <code>nvim</code> directory, or rather, the <em>store path</em> that will be
realised after your flake gets copied to the Nix store, to Neovim's runtime
directory. You may now create a <code>lua/myconfig</code> directory within this nvim
directory, and call it with <a href="#opt-vim.luaConfigRC"></a>.</p>
<pre><code class="language-nix">{pkgs, ...}: {
  vim = {
    additionalRuntimeDirectories = [
      # You can list more than one file here.
      ./nvim-custom-1

      # To make sure list items are ordered, use lib.mkBefore or lib.mkAfter
      # Simply placing list items in a given order will **not** ensure that
      # this list  will be deterministic.
      ./nvim-custom-2
    ];

    startPlugins = [pkgs.vimPlugins.gitsigns];

    # Neovim supports in-line syntax highlighting for multi-line strings.
    # Simply place the filetype in a /* comment */ before the line.
    luaConfigRC.myconfig = /* lua */ ''
      -- Call the Lua module from ./nvim/lua/myconfig
      require(&quot;myconfig&quot;)

      -- Any additional Lua configuration that you might want *after* your own
      -- configuration. For example, a plugin setup call.
      require('gitsigns').setup({})
    '';
  };
}
</code></pre>
<h2 id="sec-impure-absolute-dir"><a href="#impure-absolute-directory-sec-impure-absolute-dir" aria-hidden="true" class="anchor" id="impure-absolute-directory-sec-impure-absolute-dir"></a>Impure Absolute Directory</h2>
<p>As of <a href="<a href="https://github.com/neovim/neovim/pull/22128">https://github.com/neovim/neovim/pull/22128</a>">Neovim 0.9</a>, <code class="nix-var">$NVIM_APPNAME</code> is a variable expected by Neovim to
decide on the configuration directory. nvf sets this variable as <code>&quot;nvf&quot;</code>,
meaning <code>~/.config/nvf</code> will be regarded as <em>the</em> configuration directory by
Neovim, similar to how <code>~/.config/nvim</code> behaves in regular installations. This
allows some degree of Lua configuration, backed by our low-level wrapper
<a href="<a href="https://github.com/Gerg-L/mnw">https://github.com/Gerg-L/mnw</a>">mnw</a>. Creating a <code>lua/</code> directory located in
<code class="terminal"><span class="prompt">$</span> NVIM_APPNAME</code> (&quot;nvf&quot; by default) and placing your configuration in, e.g.,
<code>~/.config/nvf/lua/myconfig</code> will allow you to <code>require</code> it as a part of the Lua
module system through nvf's module system.</p>
<p>Let's assume your <code>~/.config/nvf/lua/myconfig/init.lua</code> consists of the
following:</p>
<pre><code class="language-lua">-- init.lua
vim.keymap.set(&quot;n&quot;, &quot; &quot;, &quot;&lt;Nop&gt;&quot;, { silent = true, remap = false })
vim.g.mapleader = &quot; &quot;
</code></pre>
<p>The following Nix configuration via <a href="#opt-vim.luaConfigRC"></a> will allow loading
this</p>
<pre><code class="language-nix">{
  # The attribute name &quot;myconfig-dir&quot; here is arbitrary. It is required to be
  # a *named* attribute by the DAG system, but the name is entirely up to you.
  vim.luaConfigRC.myconfig-dir = ''
    require(&quot;myconfig&quot;)

    -- Any additional Lua
  '';
}
</code></pre>
<p>After you load your custom configuration, you may use an <a href="options.html#option-init-lua" class="option-reference"><code>init.lua</code></a> located in
your custom configuration directory to configure Neovim exactly as you would
without a wrapper like nvf. If you want to place your <code>require</code> call in a
specific position (i.e., before or after options you set in nvf) the
<a href="<a href="https://notashelf.github.io/nvf/index.xhtml#ch-using-dags">https://notashelf.github.io/nvf/index.xhtml#ch-using-dags</a>">DAG system</a> will let you place your configuration in a location of your
choosing.</p>
<h1 id="sec-plugin-sources"><a href="#adding-plugins-from-different-sources-sec-plugin-sources" aria-hidden="true" class="anchor" id="adding-plugins-from-different-sources-sec-plugin-sources"></a>Adding Plugins From Different Sources</h1>
<p><strong>nvf</strong> attempts to avoid depending on Nixpkgs for Neovim plugins. For the most
part, this is accomplished by defining each plugin's source and building them
from source.</p>
<p>To define plugin sources, we use <a href="<a href="https://github.com/andir/npins">https://github.com/andir/npins</a>">npins</a> and pin each plugin source using
builtin fetchers. You are not bound by this restriction. In your own
configuration, any kind of fetcher or plugin source is fine.</p>
<h2 id="ch-plugins-from-nixpkgs"><a href="#nixpkgs--friends-ch-plugins-from-nixpkgs" aria-hidden="true" class="anchor" id="nixpkgs--friends-ch-plugins-from-nixpkgs"></a>Nixpkgs &amp; Friends</h2>
<p><a href="options.html#option-vim-startPlugins" class="option-reference"><code>vim.startPlugins</code></a> and <a href="options.html#option-vim-optPlugins" class="option-reference"><code>vim.optPlugins</code></a> options take either a <strong>string</strong>, in
which case a plugin from nvf's internal plugins registry will be used, or a
<strong>package</strong>. If your plugin does not require any setup, or ordering for it s
configuration, then it is possible to add it to <a href="options.html#option-vim-startPlugins" class="option-reference"><code>vim.startPlugins</code></a> to load it on
startup.</p>
<pre><code class="language-nix">{pkgs, ...}: {
  # Aerial does require some setup. In the case you pass a plugin that *does*
  # require manual setup, then you must also call the setup function.
  vim.startPlugins = [pkgs.vimPlugins.aerial-nvim];
}
</code></pre>
<p>This will fetch aerial.nvim from nixpkgs, and add it to Neovim's runtime path to
be loaded manually. Although for plugins that require manual setup, you are
encouraged to use <a href="<a href="https://notashelf.github.io/nvf/options.html#opt-vim.extraPlugins">https://notashelf.github.io/nvf/options.html#opt-vim.extraPlugins</a>"><a href="options.html#option-vim-extraPlugins" class="option-reference"><code>vim.extraPlugins</code></a></a>.</p>
<pre><code class="language-nix">{
  vim.extraPlugins = {
    aerial = {
      package = pkgs.vimPlugins.aerial-nvim;
      setup = &quot;require('aerial').setup {}&quot;;
    };
  };
}
</code></pre>
<p>More details on the extraPlugins API is documented in the
<a href="<a href="https://notashelf.github.io/nvf/index.xhtml#ch-custom-plugins">https://notashelf.github.io/nvf/index.xhtml#ch-custom-plugins</a>">custom plugins section</a>.</p>
<h2 id="ch-plugins-from-source"><a href="#building-your-own-plugins-ch-plugins-from-source" aria-hidden="true" class="anchor" id="building-your-own-plugins-ch-plugins-from-source"></a>Building Your Own Plugins</h2>
<p>In the case a plugin is not available in Nixpkgs, or the Nixpkgs package is
outdated (or, more likely, broken) it is possible to build the plugins from
source using a tool, such as <a href="<a href="https://github.com/andir/npins">https://github.com/andir/npins</a>">npins</a>. You may also use your <em>flake inputs</em> as
sources.</p>
<p>Example using plugin inputs:</p>
<pre><code class="language-nix">{
  # In your flake.nix
  inputs = {
    aerial-nvim = {
      url = &quot;github:stevearc/aerial.nvim&quot;
      flake = false;
    };
  };

  # Make sure that 'inputs' is properly propagated into Nvf, for example, through
  # specialArgs.
  outputs = { ... };
}
</code></pre>
<p>In the case, you may use the input directly for the plugin's source attribute in
<code>buildVimPlugin</code>.</p>
<pre><code class="language-nix"># Make sure that 'inputs' is properly propagated! It will be missing otherwise
# and the resulting errors might be too obscure.
{inputs, ...}: let
  aerial-from-source = pkgs.vimUtils.buildVimPlugin {
      name = &quot;aerial-nvim&quot;;
      src = inputs.aerial-nvim;
    };
in {
  vim.extraPlugins = {
    aerial = {
      package = aerial-from-source;
      setup = &quot;require('aerial').setup {}&quot;;
    };
  };
}
</code></pre>
<p>Alternatively, if you do not want to keep track of the source using flake inputs
or npins, you may call <code>fetchFromGitHub</code> (or other fetchers) directly. An
example would look like this.</p>
<pre><code class="language-nix">regexplainer = buildVimPlugin {
  name = &quot;nvim-regexplainer&quot;;
  src = fetchFromGitHub {
    owner = &quot;bennypowers&quot;;
    repo = &quot;nvim-regexplainer&quot;;
    rev = &quot;4250c8f3c1307876384e70eeedde5149249e154f&quot;;
    hash = &quot;sha256-15DLbKtOgUPq4DcF71jFYu31faDn52k3P1x47GL3+b0=&quot;;
  };

  # The 'buildVimPlugin' imposes some &quot;require checks&quot; on all plugins build from
  # source. Failing tests, if they are not relevant, can be disabled using the
  # 'nvimSkipModule' argument to the 'buildVimPlugin' function.
  nvimSkipModule = [
    &quot;regexplainer&quot;
    &quot;regexplainer.buffers.init&quot;
    &quot;regexplainer.buffers.popup&quot;
    &quot;regexplainer.buffers.register&quot;
    &quot;regexplainer.buffers.shared&quot;
    &quot;regexplainer.buffers.split&quot;
    &quot;regexplainer.component.descriptions&quot;
    &quot;regexplainer.component.init&quot;
    &quot;regexplainer.renderers.narrative.init&quot;
    &quot;regexplainer.renderers.narrative.narrative&quot;
    &quot;regexplainer.renderers.init&quot;
    &quot;regexplainer.utils.defer&quot;
    &quot;regexplainer.utils.init&quot;
    &quot;regexplainer.utils.treesitter&quot;
  ];
}
</code></pre>
</main>
      </div>

      <footer>
        <p></p>
      </footer>
    </div>

    
  </body>
</html>
